# Generated by Django 2.2.14 on 2021-03-15 20:37

from django.conf import settings
from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('logger', '0016_remove_conflicting_view_permissions'),
    ]

    operations = []

    # This AlterUniqueTogether step can fail with
    #   ValueError: Found wrong number (0) of constraints for logger_xform(user_id, sms_id_string) # noqa
    # when the database specifies the constraint in the opposite order,
    # i.e. (sms_id_string, user_id). Let's try ignoring the
    # `unique_together` change and simply depend upon the database
    # automatically removing the constraint when the `sms_id_string` column
    # is dropped. See also https://code.djangoproject.com/ticket/23906.
    #
    # But, if database is SQLite, the `unique_together` constraint removal must
    # be enforced.
    if not settings.USE_POSTGRESQL:
        operations.append(
            migrations.AlterUniqueTogether(
                name='xform',
                unique_together={('user', 'id_string')},
            )
        )

    operations.append(
        migrations.RemoveField(
            model_name='xform',
            name='allows_sms',
        )
    )
    operations.append(
        migrations.RemoveField(
            model_name='xform',
            name='sms_id_string',
        )
    )
